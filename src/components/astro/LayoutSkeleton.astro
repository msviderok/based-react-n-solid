---
import SectionSkeleton from "./SectionSkeleton.astro";
---

<div
  id="layout-skeleton"
  class="fixed top-0 left-0 size-full z-100 transition-all duration-100 linear opacity-100"
>
  <div class="group/sidebar-wrapper flex min-h-svh w-full mx-auto justify-center">
    <aside
      class="border-x border-border justify-center h-svh sticky top-0 bg-background w-64 shrink-0 hidden md:grid md:grid-rows-[auto_1fr_auto]"
    >
      <div class="flex flex-col gap-4 border-b border-border p-4">
        <div>
          <div class="h-7 w-40 bg-muted animate-pulse rounded mb-1"></div>
          <div class="h-3 w-48 bg-muted animate-pulse rounded mt-1"></div>
        </div>
        <div class="h-9 w-full bg-muted animate-pulse rounded-md"></div>
      </div>
      <div class="p-4">
        <div class="h-4 w-20 bg-muted animate-pulse rounded mb-2"></div>
        <div class="space-y-2 overflow-hidden">
          <div class="h-9 w-full bg-muted animate-pulse rounded-md"></div>
          <div class="h-9 w-full bg-muted animate-pulse rounded-md"></div>
          <div class="h-9 w-full bg-muted animate-pulse rounded-md"></div>
          <div class="h-9 w-full bg-muted animate-pulse rounded-md"></div>
          <div class="h-9 w-full bg-muted animate-pulse rounded-md"></div>
          <div class="h-9 w-full bg-muted animate-pulse rounded-md"></div>
          <div class="h-9 w-full bg-muted animate-pulse rounded-md"></div>
          <div class="h-9 w-full bg-muted animate-pulse rounded-md"></div>
          <div class="h-9 w-full bg-muted animate-pulse rounded-md"></div>
          <div class="h-9 w-full bg-muted animate-pulse rounded-md"></div>
          <div class="h-9 w-full bg-muted animate-pulse rounded-md"></div>
        </div>
      </div>
      <div class="border-t border-border pt-4 px-4 pb-4">
        <div class="flex flex-col text-sm gap-2">
          <div class="h-5 w-32 bg-muted animate-pulse rounded"></div>
          <div class="h-5 w-48 bg-muted animate-pulse rounded"></div>
        </div>
      </div>
    </aside>

    <main class="bg-background flex w-full max-w-[900px] flex-col rounded-xl p-8 relative gap-10">
      <div class="space-y-10">
        <SectionSkeleton />
        <SectionSkeleton />
        <SectionSkeleton />
        <SectionSkeleton />
        <SectionSkeleton />
      </div>
    </main>
  </div>
</div>

<script>
  import { solidLoaded, reactLoaded } from "@/lib/store";
  import { effect } from "nanostores";

  const layoutSkeleton = document.getElementById("layout-skeleton");
  effect([solidLoaded, reactLoaded], (solid, react) => {
    if (solid && react) {
      layoutSkeleton?.classList.add("opacity-0");
      layoutSkeleton?.classList.remove("opacity-100");
      document.body.classList.remove("overflow-hidden");
      setTimeout(() => layoutSkeleton?.remove(), 200);
    }
  });
</script>
